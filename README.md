# malwarETL-k8s
## K8s policies/setup files for malwarETL installation

This is a set of scripts and configurations to install k8s on a local bare-metal repo, which I then run malwarETL on 
top of. 

The core of the system is an LXC/LXD cluster of ubuntu servers. The `build-scripts\builder.py` script is used to 
create the instances necessary to run k8s. Kubespray is then used via ansible to install k8s on the various LXC
instances. Because I  would like this to be fully-ha, so that I don't have to mess with it when a server goes down,
this also installs a proxy in front of the API server.

This has a few advantages: 
  1) LXC/LXD handles distributing the instances between the members of the LXD cluster, so some server distribution happens automatically.
  2) kubespary + ansible means that adding/removing/updating nodes is done in a scripted way, rather than manually tweaking nodes.
  3) using kubespray means it's using kubeadm under the hood, we we're still getting the recommended settings for much of the node setup.

## Notes

You will need to set up ssh key access from the system/account running ansible to the VMs that actually hold teh 
LXC/LXD cluster. You will need to do this for all of them. 
