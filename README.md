# malwarETL-k8s
## K8s policies/setup files for malwarETL installation

This is a set of scripts and configurations to install k8s on a local bare-metal repo, which I then run malwarETL on 
top of. 

This has a few advantages: 
  1) kubespary + ansible means that adding/removing/updating nodes is done in a scripted way, rather than manually tweaking nodes.
  2) using kubespray means it's using kubeadm under the hood, we we're still getting the recommended settings for much of the node setup.

## Note on virtualbox

DO NOT use the virtualbox that's provided by Ubuntu. It does not come with the proper vboxautostart-service, and all
my futzing couldn't get it to work properly. Install it from the .deb from virtualbox.org. I had to remove a lot of 
other auto-installed components after installing the ubuntu packaged version, as well. You should run: 
```
sudo apt-get remove virtualb*
sudo apt-get remove vbox*
```

in an empty directory before installing the virtualbox deb. (Note: it will be tempting to run an `apt-get autoremove` or 
`apt-get clean` after uninstalling the virtualbox components...that's *technically* the right thing to do, but it will
remove a bunch of components that the deb will be looking for and won't trigger an installation of itself.)

## Note on ubuntu interfaces

Ubuntu 18.04 (and probably later) install parts of lxc by default (which is part of why I started with LXC in this
whole saga). That includes some processes that create network interfaces for lxc automatically. I ended up running
` systemctl disable libvirt-guests` and `systemctl disable libvirtd` to remove those. It's not strictly necessary
to do that, you could just ignore them, but I didn't like having extra stuff confusing any troubleshooting.

