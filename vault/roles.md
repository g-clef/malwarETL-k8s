# Roles

Below are the roles to define in vault to tie the policies to the kubernetes service accounts of the various systems

sheel into the vault pod and run `vault write auth/kubernetes/role/<>` with the below extra arguments

collectors
    bound_service_account_names=*-collector
    bound_service_account_namespaces=collectors
    policies=collectors
    ttl=24h

malshare
    bound_service_account_names=malshare-collector
    bound_service_account_namespaces=collectors
    policies=malshare
    ttl=24h

pastebin
    bound_service_account_names=pastebin-collector
    bound_service_account_namespaces=pastebin
    policies=pastebin
    ttl=24h

ti-report
    bound_service_account_names=ti-report
    bound_service_account_namespaces=ti
    polices=ti-report
    ttl=24h

transformers
    bound_service_account_names=*-transformer
    bound_service_account_namespaces=transformers
    policies=transformers
    ttl=24h

prefect
    bound_service_account_names=prefect-*
    bound_service_account_namespaces=prefect
    policies=prefect
    ttl=24h

postgres
    bound_service_account_names=postgres-*
    bound_service_account_namespaces=postgres
    policies=postgres
    ttl=24h

kafka
    bound_service_account_names=kafka-*
    bound_service_account_namespaces=kafka
    policies=kafka
    ttl=24h

---
#!/bin/sh
vault write auth/kubernetes/role/collectors bound_service_account_names=*-collector bound_service_account_namespaces=collectors policies=collectors ttl=24h
vault write auth/kubernetes/role/malshare bound_service_account_names=malshare-collector bound_service_account_namespaces=collectors policies=malshare ttl=24h
vault write auth/kubernetes/role/pastebin bound_service_account_names=pastebin-collector bound_service_account_namespaces=pastebin policies=pastebin ttl=24h
vault write auth/kubernetes/role/ti-report bound_service_account_names=ti-report bound_service_account_namespaces=ti polices=ti-report ttl=24h
vault write auth/kubernetes/role/transformers bound_service_account_names=*-transformer bound_service_account_namespaces=transformers policies=transformers ttl=24h
vault write auth/kubernetes/role/prefect bound_service_account_names=prefect-* bound_service_account_namespaces=prefect policies=prefect ttl=24h
vault write auth/kubernetes/role/postgres bound_service_account_names=postgres-* bound_service_account_namespaces=postgres policies=postgres ttl=24h
vault write auth/kubernetes/role/kafka bound_service_account_names=kafka-* bound_service_account_namespaces=kafka policies=kafka ttl=24h